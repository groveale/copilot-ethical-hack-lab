
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://groveale.github.io/copilot-ethical-hack-lab/pages/extend-m365-copilot/01-declarative-copilot/">
      
      
        <link rel="prev" href="../00-prerequisites/">
      
      
        <link rel="next" href="../02-sensitive-agent/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>Lab E1 - Declarative Agent - Copilot Ethical Hack</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/labStyles.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="#35258F" data-md-color-accent="#091F2C">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-e1-customize-copilot-by-building-a-declarative-agent" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Copilot Ethical Hack" class="md-header__button md-logo" aria-label="Copilot Ethical Hack" data-md-component="logo">
      
  <img src="../../../assets/images/CopilotCamp-Tent-Clean.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Copilot Ethical Hack
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab E1 - Declarative Agent
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/groveale/copilot-ethical-hack-lab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    groveale/copilot-ethical-hack-lab
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Extend Path - Extend Copilot for Microsoft 365

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../custom-engine/" class="md-tabs__link">
          
  
  Build Path - Build your own agent

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Copilot Ethical Hack" class="md-nav__button md-logo" aria-label="Copilot Ethical Hack" data-md-component="logo">
      
  <img src="../../../assets/images/CopilotCamp-Tent-Clean.png" alt="logo">

    </a>
    Copilot Ethical Hack
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/groveale/copilot-ethical-hack-lab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    groveale/copilot-ethical-hack-lab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extend Path - Extend Copilot for Microsoft 365
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Extend Path - Extend Copilot for Microsoft 365
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-prerequisites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab E0 - Prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Lab E1 - Declarative Agent
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lab E1 - Declarative Agent
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anatomy-of-a-declarative-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Anatomy of a Declarative agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capabilities-of-a-declarative-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Capabilities of a Declarative agent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-1-scaffold-a-declarative-agent-from-template" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1: Scaffold a declarative agent from template
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exercise 1: Scaffold a declarative agent from template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-install-teams-toolkit" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Install Teams Toolkit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-use-teams-toolkit-to-create-a-declarative-agent-app" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Use Teams Toolkit to create a declarative agent app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-set-up-accounts-in-teams-toolkit" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Set up accounts in Teams Toolkit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-understanding-the-files-in-the-app" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Understanding the files in the app
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2-update-instructions-and-icons" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2: Update instructions and icons
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exercise 2: Update instructions and icons">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-update-icons-and-manifests" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Update icons and manifests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-add-conversation-starters" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2 : Add conversation starters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-test-the-app" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Test the app
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-3-add-files-for-reference-bonus-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 3: Add files for reference (Bonus exercise)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exercise 3: Add files for reference (Bonus exercise)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-upload-files-to-sharepoint" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Upload files to SharePoint.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-update-declarative-agent-manifest" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Update declarative agent manifest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-upgrade-app-manifest" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Upgrade app manifest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-test-the-app" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Test the app
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-sensitive-agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab E2 - Sensitive Agent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Build Path - Build your own agent
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Build Path - Build your own agent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/00-prerequisites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab B0 - Prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/01-custom-engine-agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab B1 - Build a custom engine agent using Azure OpenAI and Teams Toolkit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/02-rag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab B2 - Index your data in Azure AI Search and bring it into your custom engine agent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="lab-e1-customize-copilot-by-building-a-declarative-agent">Lab E1 - Customize Copilot by building a declarative agent</h1>
<p>In this lab, you'll build a simple declarative agent using Teams Toolkit for Visual Studio Code. Your agent is designed to give you a fun and educational break from work by helping you explore cities across the globe. It presents abstract clues for you to guess a city, with fewer points awarded the more clues you use. At the end, your final score will be revealed.</p>
<details open="open">
<summary>Navigating the Extend Copilot labs (Extend Path)</summary>
<ul>
<li><a href="../00-prerequisites/">Lab E0 - Prerequisites</a></li>
<li><a href="./">Lab E1 - Declarative agent</a> (📍You are here)</li>
</ul>
</details>
<div class="admonition warning">
<p class="admonition-title">Reminder</p>
<p>To perform the following exercise, your developer tenant should be under private preview program and your account must have a valid license for Copilot for Microsoft 365 as well.</p>
</div>
<div class="admonition abstract">
<p class="admonition-title">Table of Contents</p>
<p><cc-table-of-contents /></p>
</div>
<p>In this lab you will learn:</p>
<ul>
<li>What is a declarative agent for Microsoft 365 Copilot</li>
<li>Install <a href="https://github.com/OfficeDev/teams-toolkit/actions/runs/10846087381" target="_blank">Teams toolkit for VS Code from this link</a></li>
<li>Create a declarative agent using Teams Toolkit template</li>
<li>Customise the agent to create the geo locator game using instructions </li>
<li>Learn how to run and test your app </li>
<li>For bonus exercise, you will need a SharePoint teams site</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Declarative agents leverage the same scalable infrastructure and platform of Microsoft 365 Copilot, tailored specifically to meet focus on a special area of your needs.
They function as subject matter experts in a specific area or business need, allowing you to use the same interface as a standard Microsoft 365 Copilot chat while ensuring they focus exclusively on the specific task at hand. </p>
<p>Welcome on board to building your own declarative agent ☺️! Let's dive in and make your Copilot work magic!</p>
<p>In this lab you will start out building a declarative agent using Teams Toolkit with a default template used in the tool. This is to help you get started with something.
Next, you will modify your agent to be focused on a geo location game. </p>
<p>The goal of your AI is to provide a fun break from work while helping you learn about different cities around the world. It offers abstract clues for you to identify a city. The more clues you need, the fewer points you earn. At the end of the game, it will reveal your final score.</p>
<p><img alt="game" src="../../../assets/images/extend-m365-copilot-01/game.png" /></p>
<p>As a bonus you will also give your agent some files to refer to a secret diary 🕵🏽 and a map 🗺️ to give more challenges to the player. </p>
<p>So let's begin 💪🏼</p>
<h2 id="anatomy-of-a-declarative-agent">Anatomy of a Declarative agent</h2>
<p>You will see as we develop more and more extensions to Copilot,  that in the end what you will build is collection of few files in a zip file which we will refer to as an <code>app package</code> that you will  then install and use. So it's important you have a basic understanding of what the app package consists of. The app package of a declarative agent is similar to a Teams app if you have built one before with additonal elements. See the table to see all the core elements. You will also see that the app deployment process is very similar to deploying a teams app. </p>
<table>
<thead>
<tr>
<th>Element</th>
<th>Description</th>
<th>Name of file</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>App manifest</strong></td>
<td>Describes app configuration, capabilities, required resources, and important attributes.</td>
<td>manifest.json</td>
</tr>
<tr>
<td><strong>App icons</strong></td>
<td>Requires a color (192x192) and outline (32x32) icon for your declarative agent.</td>
<td>icon.png, color.png</td>
</tr>
<tr>
<td><strong>Declarative agent manifest</strong></td>
<td>Describes agent configuration, instructions, required fields, capabilities, conversation starters, and actions.</td>
<td>declarativeAgent.json</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can add reference data form SharePoint, OneDrive, Websearch etc and add extension capabilities to a declarative agent like plugins and connectors. You will learn how to add a plugin in the upcoming labs in this path. </p>
</div>
<h2 id="capabilities-of-a-declarative-agent">Capabilities of a Declarative agent</h2>
<p>You can enhance the agent's focus on context and data by not only adding instructions but also specifying the knowledge base it should access.
They are called capabilities and there are three types of capabilities supported.</p>
<ul>
<li><strong>Microsoft Graph Connectors</strong> - Pass connections of Graph connectors into the agent, allowing the agent to access and utilize the connector's knowledge.</li>
<li><strong>OneDrive and SharePoint</strong> - Provides URLs of files and sites to agent, for it to gain access to those contents.</li>
<li><strong>Web search</strong> - Enables or disables web content as part of the agent's knowledge base.</li>
</ul>
<p><img alt="capabilities of declarative agents" src="../../../assets/images/extend-m365-copilot-01/capabiltities-da.png" /></p>
<div class="admonition tip">
<p class="admonition-title">OnDrive and SharePoint</p>
<p>URLs should be full path to SharePoint items (site, document library, folder, or file). You can use the "Copy direct link" option in SharePoint to get the full path or files and folders. To achieve this, right-click on the file or folder and select Details. Navigate to Path and click on the copy icon.<mark> Not specifying the URLs, the entire corpus of OneDrive and SharePoint content available to the logged in user will be used by the agent.</mark></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Microsoft Graph Connector</p>
<p>Not specifying the connections, the entire corpus of Graph Connectors content available to the logged in user will be used by the agent.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Web search</p>
<p>At the moment you cannot pass specific websites or domains and this acts only as a toggle on and off to use web. </p>
</div>
<h2 id="exercise-1-scaffold-a-declarative-agent-from-template">Exercise 1: Scaffold a declarative agent from template</h2>
<p>You can use just any editor to create a declarative agent if you know the structure of the files in the app package mentioned above. But things are easier if you use a tool like Teams Toolkit to not only create these files for you but also help you deploy and publish your app. 
So to keep things as simple as possible you will use Teams Toolkit.</p>
<h3 id="step-1-install-teams-toolkit">Step 1: Install Teams Toolkit</h3>
<p>https://aka.ms/json-schemas/copilot/declarative-agent/v1.0/schema.json</p>
<div class="admonition warning">
<p class="admonition-title">This step is temporary</p>
<p>For now you will need to use this hotfix version until the feature is available in Teams Toolkit as either Preview or Stable Release</p>
</div>
<ul>
<li>Go to extensions tab of your Visual Studio Code and type <strong>team</strong> as in step 1️⃣ in the image below.</li>
<li>Select <strong>Teams Toolkit</strong> as step 2️⃣. </li>
<li>Select <strong>Switch to Pre-Release Version</strong>  3️⃣ <mark>v5.9.2024091405 (pre-release)</mark></li>
</ul>
<p><img alt="prerelease version install" src="../../../assets/images/extend-m365-copilot-01/prerelease-ttk.png" /></p>
<div class="admonition tip">
<p class="admonition-title">Teams Toolkit Prerelease</p>
<p>Only this lab uses prerelease version of Teams Toolkit. You can switch back to release version after this lab is completed. The steps are similar to above.</p>
</div>
<p><cc-lab-end-step lab="e1" exercise="1" step="1" /></p>
<h3 id="step-2-use-teams-toolkit-to-create-a-declarative-agent-app">Step 2: Use Teams Toolkit to create a declarative agent app</h3>
<p>Go to the Teams Toolkit extension in your Visual Studio Code editor and select <strong>Create a New App</strong></p>
<p><img alt="start creating the base app" src="../../../assets/images/extend-m365-copilot-01/create-new-app.png" /></p>
<p>A panel opens up where you need to select <strong>Copilot Agent</strong> from the list of project types.</p>
<p><img alt="project types" src="../../../assets/images/extend-m365-copilot-01/copilot-extension.png" /></p>
<p>Next, you will be asked to choose the app feature of Copilot Agent. Choose <code>declarative agent</code> and select Enter. </p>
<p><img alt="app feature types" src="../../../assets/images/extend-m365-copilot-01/app-feature.png" /></p>
<p>Next, you will be asked to choose want to create a basic declarative agent or one with an API plugin.  Choose the <strong>No Plugin</strong> option.</p>
<p><img alt="select the type of declarative agent" src="../../../assets/images/extend-m365-copilot-01/type.png" /></p>
<div class="admonition tip">
<p class="admonition-title">Why not create one with API plugin here? </p>
<p>You will build API plugins in the next lab and you will also learn how to integrate an API plugin with a declarative agent in the following one in this same path. Here we are just going to create a declarative agent. Baby steps!</p>
</div>
<p>Next, type in the directory where the project folder has to be created.</p>
<p><img alt="choose the folder" src="../../../assets/images/extend-m365-copilot-01/folder.png" /></p>
<p>Next, give it an application name <code>Geo Locator Game</code> and select Enter. </p>
<p><img alt="type in application name" src="../../../assets/images/extend-m365-copilot-01/name.png" /></p>
<p>The project will be created in a few seconds in the folder you mentioned and will open up in a new project window of Visual Studio Code. This is your working folder.</p>
<p><img alt="project created" src="../../../assets/images/extend-m365-copilot-01/project-scffolded.png" /></p>
<p>Well done! You have successfully set up the base declarative Copilot app! Now, proceed to examine the files contained within to be able to customise it to make the geo locator game app. </p>
<p><cc-lab-end-step lab="e1" exercise="1" step="2" /></p>
<h3 id="step-3-set-up-accounts-in-teams-toolkit">Step 3: Set up accounts in Teams Toolkit</h3>
<p>Now select the Teams Toolkit icon in the left 1️⃣ . Under "Accounts" click "Sign in to Microsoft 365" 2️⃣ and log in with your own Microsoft 365 account.</p>
<p><img alt="Logging into Microsoft 365 from within Teams Toolkit" src="../../../assets/images/extend-m365-copilot-01/01-04-Setup-TTK-01.png" /></p>
<p>A browser window will pop up and offer to log into Microsoft 365. When it says "You are signed in now and close this page", please do so.</p>
<p>Now verify that the "Custom App Upload Enabled" checker has a green checkmark. If it doesn't, that means that your user account doesn't have permission to upload Teams applications. Follow steps in Exercise 1 of this lab. </p>
<p>Now verify that the "Copilot Access Enabled" checker has a green checkmark. If it doesn't, that means that your user account license for Copilot. This is required to continue the labs.</p>
<p><img alt="Checker" src="../../../assets/images/extend-m365-copilot-01/checker.png" /></p>
<p>Now, let's do a code tour.</p>
<p><cc-lab-end-step lab="e1" exercise="1" step="3" /></p>
<h3 id="step-4-understanding-the-files-in-the-app">Step 4: Understanding the files in the app</h3>
<p>Here's how the base project looks: </p>
<table>
<thead>
<tr>
<th>Folder/File</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.vscode</code></td>
<td>VSCode files for debugging</td>
</tr>
<tr>
<td><code>appPackage</code></td>
<td>Templates for the Teams application manifest, the GPT manifest, and the API specification</td>
</tr>
<tr>
<td><code>env</code></td>
<td>Environment files with a default  <code>.env.dev</code>    file</td>
</tr>
<tr>
<td><code>appPackage/color.png</code></td>
<td>Application logo image</td>
</tr>
<tr>
<td><code>appPackage/outline.png</code></td>
<td>Application logo outline image</td>
</tr>
<tr>
<td><code>appPackage/declarativeAgent.json</code></td>
<td>Defines settings and configurations of the declarative agent.</td>
</tr>
<tr>
<td><code>appPackage/instruction.txt</code></td>
<td>Defines the behaviour of declarative agent.</td>
</tr>
<tr>
<td><code>appPackage/manifest.json</code></td>
<td>Teams application manifest that defines metadata for your declarative agent.</td>
</tr>
<tr>
<td><code>teamsapp.yml</code></td>
<td>Main Teams Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions.</td>
</tr>
</tbody>
</table>
<p>The file of interest for our lab is primarily the <strong>appPackage/instruction.txt</strong> file which is the core directives needed for your agent.
It's a plain text file and you can write natural language instructions in it. </p>
<p>Another important file is <strong>appPackage/declarativeAgent.json</strong> where there is a schema to be followed to extend Microsoft 365 Copilot with the new declarative agent. Let's look at what propertis the schema of this file has. </p>
<ul>
<li>The <code>$schema</code> is the schema reference </li>
<li>The <code>version</code> is the schema version </li>
<li>The <code>name</code> key represents the name of the declarative agent.</li>
<li>The <code>description</code> provides a description.</li>
<li>The <code>instructions</code> the path to the <strong>instructions.txt</strong> file which holds directives which will determine the operational behavior. You can also put your instructions as plain text as a value here. But for this lab we will use the <strong>instructions.txt</strong> file.</li>
</ul>
<p>Another important file is the <code>appPackage/manifest.json</code> file, which contains crucial metadata, including the package name, the developer’s name, and references to the copilot extensions utilised by the application. The following section from the manifest.json file illustrates these details:</p>
<pre><code class="language-JSON">&quot;copilotExtensions&quot;: {
        &quot;declarativeCopilots&quot;: [            
            {
                &quot;id&quot;: &quot;declarativeAgent&quot;,
                &quot;file&quot;: &quot;declarativeAgent.json&quot;
            }
        ]
    },
</code></pre>
<p>You could also update the logo files <code>color.png</code> and <code>outline.png</code> to make it match your application's brand. In today's lab you will change <strong>color.png</strong> icon for the agent to stand out. </p>
<p><cc-lab-end-step lab="e1" exercise="1" step="4" /></p>
<h2 id="exercise-2-update-instructions-and-icons">Exercise 2: Update instructions and icons</h2>
<h3 id="step-1-update-icons-and-manifests">Step 1: Update icons and manifests</h3>
<p>First we will do the easy bit which is replacing the logo. Copy the image located <a href="../../../assets/images/extend-m365-copilot-01/color.png" target="_blank">here</a> and replace it with the image of same name in the folder <strong>appPackage</strong> in your root project. </p>
<p>Next, go to the file <strong>appPackage/manifest.json</strong>  in your root project and find the node <strong>copilotExtensions</strong>. Update the id value of the declarativeAgents array's first entry from <code>declarativeAgent</code> to <code>dcGeolocator</code> to make this ID unique.</p>
<pre>
 "copilotExtensions": {
        "declarativeCopilots": [            
            {
                "id": "<b>dcGeolocator</b>",
                "file": "declarativeAgent.json"
            }
        ]
    },

</pre>

<p>Next, go to the file <strong>appPackage/instruction.txt</strong> and copy paste the below instruction to overwrite the existing contents of the file.</p>
<pre><code class="language-txt">System Role: You are the game host for a geo-location guessing game. Your goal is to provide the player with clues about a specific city and guide them through the game until they guess the correct answer. You will progressively offer more detailed clues if the player guesses incorrectly. You will also reference PDF files in special rounds to create a clever and immersive game experience.

Game play Instructions:
Game Introduction Prompt
Use the following prompt to welcome the player and explain the rules:
Welcome to the Geo Location Game! I’ll give you clues about a city, and your task is to guess the name of the city. After each wrong guess, I’ll give you a more detailed clue. The fewer clues you use, the more points you score! Let’s get started. Here’s your first clue:
Clue Progression Prompts
Start with vague clues and become progressively specific if the player guesses incorrectly. Use the following structure:
Clue 1: Provide a general geographical clue about the city (e.g., continent, climate, latitude/longitude).
Clue 2: Offer a hint about the city’s landmarks or natural features (e.g., a famous monument, a river).
Clue 3: Give a historical or cultural clue about the city (e.g., famous events, cultural significance).
Clue 4: Offer a specific clue related to the city’s cuisine, local people, or industry.
Response Handling
After the player’s guess, respond accordingly:

If the player guesses correctly, say:
That’s correct! You’ve guessed the city in [number of clues] clues and earned [score] points. Would you like to play another round?
If the guess is wrong, say:
That’s correct! You’ve guessed the city in [number of clues] clues and earned [score] points. Would you like to play another round?
PDF-Based Scenario
For special rounds, use a PDF file to provide clues from a historical document, traveler's diary, or ancient map:
This round is different! I’ve got a secret document to help us. I’ll read clues from this [historical map/traveler’s diary] and guide you to guess the city. Here’s the first clue:
Reference the specific PDF to extract details:
Traveler's Diary PDF,Historical Map PDF.
Use emojis where necessary to have friendly tone. 
Scorekeeping System
Track how many clues the player uses and calculate points:

1 clue: 10 points
2 clues: 8 points
3 clues: 5 points
4 clues: 3 points
End of Game Prompt
After the player guesses the city or exhausts all clues, prompt:
Would you like to play another round, try a special challenge?

</code></pre>
<p>Follow the next step to make sure our agent can help user engage with it by giving conversation starters.  </p>
<div class="admonition tip">
<p class="admonition-title">Include your own files in <strong>appPackage</strong> files</p>
<p>Notice this line in <strong>appPackage/declarative-copilot.json</strong>:</p>
<p><code>"instructions": "$[file('instruction.txt')]",</code></p>
<p>This brings in your instructions from the <strong>instruction.txt</strong> file. If you want to modularize your packaging files, you can use this technique in any of the JSON files in the <strong>appPackage</strong> folder.</p>
</div>
<p><cc-lab-end-step lab="e1" exercise="2" step="1" /></p>
<h3 id="step-2-add-conversation-starters">Step 2 : Add conversation starters</h3>
<p>You can enhance user engagement with the declarative agent by adding conversation starters to it. </p>
<p>Some of the benefits of having conversation starters are: </p>
<ul>
<li>
<p><strong>Engagement</strong>: They help initiate interaction, making users feel more comfortable and encouraging participation.</p>
</li>
<li>
<p><strong>Context Setting</strong>: Starters set the tone and topic of the conversation, guiding users on how to proceed.</p>
</li>
<li>
<p><strong>Efficiency</strong>: By leading with a clear focus, starters reduce ambiguity, allowing the conversation to progress smoothly.</p>
</li>
<li>
<p><strong>User Retention</strong>: Well-designed starters keep users interested, encouraging repeat interactions with the AI.</p>
</li>
</ul>
<p>Open file <code>declarativeAgent.json</code> and right after the <code>instructions</code> node add a comma <code>,</code> and paste below code.</p>
<pre><code class="language-JSON"> &quot;conversation_starters&quot;: [
      { 
            &quot;title&quot;: &quot;Getting Started&quot;,
            &quot;text&quot;:&quot;I am ready to play the Geo Location Game! Give me a city to guess, and start with the first clue.&quot;          

         },
        {
            &quot;title&quot;: &quot;Ready for a Challenge&quot;,
            &quot;text&quot;: &quot;Let us try something different. Can we play a round using the travelers diary?&quot;
        },
        { 
            &quot;title&quot;: &quot;Feeling More Adventurous&quot;,
            &quot;text&quot;: &quot;I am in the mood for a challenge! Can we play the game using the historical map? I want to see if I can figure out the city from those ancient clues.&quot;
        }
    ]
</code></pre>
<p>Now all the changes are done to the agent, it's time to test it.</p>
<p><cc-lab-end-step lab="e1" exercise="2" step="2" /></p>
<h3 id="step-3-test-the-app">Step 3: Test the app</h3>
<p>To test the app go to the <code>Teams Toolkit</code> extension in <code>Visual Studio Code</code>. This will open up the left pane. Under "LIFECYCLE" select "Provision".  You can see the value of Teams Toolkit here, as it makes publishing so simple. </p>
<p><img alt="provision" src="../../../assets/images/extend-m365-copilot-01/provision.png" /></p>
<p>In this step Teams toolkit will package up all the files inside the <code>appPackage</code> folder as a zip file and install the declarative agent to your own app catalog.</p>
<div class="admonition warning">
<p class="admonition-title">Private Preview not enabled</p>
<p>Provision step will fail if the user is using a Tenant without Private Preview enabled. </p>
</div>
<p>Go to Teams in browser <a href="https://teams.microsoft.com/v2/">https://teams.microsoft.com/v2/</a> logged into your developer tenant.
If you have a Microsoft 365 Copilot, the new app will be automatically pinned above your chats. Just open Teams, select “chats” and you’ll see Copilot.</p>
<p>Once the Copilot app is loaded, Find the "Geo Locator Game" from the right panel as shown. </p>
<p><img alt="launch" src="../../../assets/images/extend-m365-copilot-01/launch-geo.png" /></p>
<p>If you can't find it, this may be a long list and you can find your agent by expanding the list by selecting "see more"</p>
<p>Once launched, you will be in this focused chat window with the agent. And you will see the conversation starters as marked below:</p>
<p><img alt="launched" src="../../../assets/images/extend-m365-copilot-01/launched-geo.png" /></p>
<p>Select one of the conversation starters and it will fill your compose message box with the starter prompt, just waiting for you to hit "Enter". It is still only your assistant and will wait for you to take action 🟢</p>
<p>Check out the demo of the game. </p>
<p><img alt="demo" src="../../../assets/images/extend-m365-copilot-01/demo.gif" /></p>
<p><cc-lab-end-step lab="e1" exercise="2" step="3" /></p>
<h2 id="exercise-3-add-files-for-reference-bonus-exercise">Exercise 3: Add files for reference (Bonus exercise)</h2>
<p>Playing the same game over and over can get dull. To keep things fun and engaging, the game needs access to data that’s regularly updated. Let’s give the agent a new ability to refresh the game and ramp up the challenge. As we covered earlier, declarative agents can have three main capabilities, one of which is referencing SharePoint sites and OneDrive. So, let's go ahead and add the ability for your agent to access a couple of files.</p>
<h3 id="step-1-upload-files-to-sharepoint">Step 1: Upload files to SharePoint.</h3>
<div class="admonition note">
<p class="admonition-title">CSU Chats and hacks!</p>
<p>I've created a SPO site for this so please use <code>https://microsoft.sharepoint-df.com/teams/CSUEthicalSafeguardingHackTestdata</code> </p>
</div>
<p>Download this zip file consisting of two PDF file by selecting this <a href="https://download-directory.github.io/?url=https://github.com/microsoft/copilot-camp/tree/main/src/extend-m365-copilot/path-e-lab01-declarative-copilot/geo-locator-lab-sample/sharepoint-docs&amp;filename=sharepoint-docs" target="_blank">link</a></p>
<p>Extract the two files from the zip and upload to a SharePoint Teams site in the same tenant in the document library <strong>Documents</strong>.
These documents are <strong>historical_map.pdf</strong> and <strong>travelers_diary</strong> to help make the game more challenging. </p>
<p>Copy the absolute url of the site. <code>https://microsoft.sharepoint-df.com/teams/CSUEthicalSafeguardingHackTestdata</code> and proceed to next step.</p>
<p><cc-lab-end-step lab="e1" exercise="3" step="1" /></p>
<h3 id="step-2-update-declarative-agent-manifest">Step 2: Update declarative agent manifest</h3>
<p>Go to the environment file called <strong>.env.dev</strong> and create a new variable called "SP_SITE_URL" and paste the absolute url of the SharePoint site as its value.</p>
<p>Next, go to the agent manifest <strong>appPackage/declarativeAgent.json</strong> and add a comma <code>,</code> after conversation_starters array and paste the belwo new array object for extending the agent's capability to refer to SharePoint data of a particular site.</p>
<pre><code class="language-JSON"> &quot;capabilities&quot;: [
        {

            &quot;name&quot;: &quot;OneDriveAndSharePoint&quot;,
            &quot;items_by_url&quot;: [
            {
                &quot;url&quot;: &quot;${{SP_SITE_URL}}&quot;
            }
        ]
        }
    ]
</code></pre>
<p>This widens declarative agent's knowledge to read documents in this SharePoint site specifically to help spice up the game. 
There is no limit to how many URLs you can add 💪🏼</p>
<p><cc-lab-end-step lab="e1" exercise="3" step="2" /></p>
<h3 id="step-3-upgrade-app-manifest">Step 3: Upgrade app manifest</h3>
<p>Next, go to the file <strong>appPackage/manifest.json</strong> and upgrade the manifest version from "1.0.0"" to "1.0.1" so the changes are reflected when you install. </p>
<p><cc-lab-end-step lab="e1" exercise="3" step="3" /></p>
<h3 id="step-4-test-the-app">Step 4: Test the app</h3>
<ul>
<li>
<p>To test the app go back to the <code>Teams Toolkit</code> extension in <code>Visual Studio Code</code>. This will open up the left pane. Under "LIFECYCLE" select "Provision" for packaging and installing the upgraded declarative agent to your own app catalog.</p>
</li>
<li>
<p>Go to Teams in browser <a href="https://teams.microsoft.com/v2/">https://teams.microsoft.com/v2/</a> logged into your developer tenant.</p>
</li>
<li>
<p>Open the Copilot app and launch the "Geo Locator Game" again.</p>
</li>
</ul>
<p><img alt="launched" src="../../../assets/images/extend-m365-copilot-01/launched-geo.png" /></p>
<p>This time, try the challenge which will be based on the travel diary. Choose the second converation starter.</p>
<p><img alt="traveller" src="../../../assets/images/extend-m365-copilot-01/traveller.png" /></p>
<p>You have basically become a declarative agent boss. Find out more from this video we did.</p>
<p>[place holder for video]</p>
<p><cc-lab-end-step lab="e1" exercise="3" step="4" /></p>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/overview-declarative-copilot">Declarative agents</a></li>
<li><a href="https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/declarative-agent-manifest">Declarative agent manifest schema</a></li>
<li><a href="https://learn.microsoft.com/en-us/microsoftsearch/semantic-index-for-copilot#supported-content-types">Supported content types</a></li>
<li><a href="https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/declarative-agent-capabilities-ids?tabs=explorer">Capabilities of Declarative agents</a></li>
</ul>
<p>Great job on building your game agent 🎉 ! In the next lab, you’ll create a REST API, use it to build a plugin, and dive into a real-world business scenario solved by another agent. Exciting stuff ahead. Select <strong>Next</strong></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="../../../javascripts/next-button.js"></script>
      
        <script src="../../../javascripts/cc-lab-step.js"></script>
      
    
  </body>
</html>